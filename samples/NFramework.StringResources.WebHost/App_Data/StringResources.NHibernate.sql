															/*

파일명 : Resource.sql

설명 : 
	Application 환경에서의 String Resource 정보를 Database에서 제공하기 위해 
	Resource 정보를 DB Table에 저장해 둔다.

	제품별로 Resource를 관리할 수 있다. 
	만약 회사마다 구분하고 싶다면 TABLE을 따로 만들어서 복사하는 것이 좋을 것이다.	

만든이 : 배성혁 (debop@realweb21.com)


개발이력 :

	2009-12-21 : ADO.NET 용으로 제공하기 위해 RCL_RESOURCE_VIEW 제공
	2007-02-23 : 최초 작성
	2007-08-20 : NHibernate 를 적용하고, Locale 관련 Table을 분리했음.
	
*/

use StringResourcesDB
GO

IF OBJECT_ID('FK_RCL_RESOURCE_LOCALE_RCL_RESOURCE') <> 0 and OBJECT_ID('RCL_RESOURCE_LOCALE') <>0
	ALTER TABLE RCL_RESOURCE_LOCALE DROP CONSTRAINT FK_RCL_RESOURCE_LOCALE_RCL_RESOURCE
GO

if OBJECT_ID('RCL_RESOURCE_LOCALE') <> 0
	DROP TABLE RCL_RESOURCE_LOCALE
GO

if OBJECT_ID('RCL_RESOURCE') <> 0
	DROP TABLE RCL_RESOURCE
GO

CREATE TABLE dbo.RCL_RESOURCE
(
	RES_ID			int identity(1,1) not null,
	ASSEMBLY_NAME	nvarchar(128)	null,
	SECTION_NAME	nvarchar(128)	not null,
	RES_KEY			nvarchar(128)	not null,
	RES_VALUE		nvarchar(MAX)	null,

	CONSTRAINT PK_RCL_RESOURCE PRIMARY KEY NONCLUSTERED
	(
		RES_ID ASC
	) ON [PRIMARY],

	CONSTRAINT IX_UNIQUE_RESOURCE_KEY UNIQUE CLUSTERED
	(
		ASSEMBLY_NAME	ASC,
		SECTION_NAME	ASC,
		RES_KEY			ASC
	) ON [PRIMARY]
) ON [PRIMARY]

GO

CREATE TABLE dbo.RCL_RESOURCE_LOCALE
(
	RES_ID		INT				NOT NULL,
	LOCALE_KEY	VARCHAR(128)	NOT NULL,
	RES_VALUE	NVARCHAR(MAX)	NULL

	CONSTRAINT PK_RCL_RESOURCE_LOCALE PRIMARY KEY CLUSTERED
	(
		RES_ID		ASC,
		LOCALE_KEY	ASC
	) ON [PRIMARY]

	
) ON [PRIMARY]

GO

ALTER TABLE RCL_RESOURCE_LOCALE WITH CHECK ADD CONSTRAINT FK_RCL_RESOURCE_LOCALE_RCL_RESOURCE 
FOREIGN KEY(RES_ID)
REFERENCES RCL_RESOURCE (RES_ID)
GO

-- SAMPLE DATA

DECLARE @RES_ID INT

INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES (NULL, 'Glossary', 'HomePage', '홈페이지(default)')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '홈페이지 (ko-KR)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '홈페이지 (ko)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'HomePage (en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'HomePage (en-US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'HomePage (en-CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES (NULL, 'Glossary', 'SiteMap', '사이트 맵(default)')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '사이트 맵(ko-KR)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '사이트 맵(ko)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'SiteMap(en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'SiteMap (US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'SiteMap (CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES (NULL, 'Glossary', 'Welcome', '${HomePage}에 오신것을 환영합니다. (default)')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '${HomePage}에 오신것을 환영합니다. (ko-KR)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '${HomePage}에 오신것을 환영합니다. (ko)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'Welcome to ${HomePage} (en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'Welcome to ${HomePage} (US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'Welcome to ${HomePage} (CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES (NULL, 'CommonTerms', 'Hello', '안녕하세요. ${Glossary|HomePage}에 오신것을 환영합니다.')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '안녕하세요. ${Glossary|HomePage}에 오신것을 환영합니다.')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '안녕하세요. ${Glossary|HomePage}에 오신것을 환영합니다.')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'Hello, Welcome to ${Glossary|HomePage} (en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'Hello, Welcome to ${Glossary|HomePage} (US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'Hello, Welcome to ${Glossary|HomePage} (CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES ('OtherResources', 'Glossary', 'HomePage', '홈페이지(default)')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '홈페이지 (ko-KR)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '홈페이지 (ko)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'HomePage (en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'HomePage (en-US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'HomePage (en-CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES ('OtherResources', 'Glossary', 'SiteMap', '사이트 맵(default)')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '사이트 맵(ko-KR)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '사이트 맵(ko)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'SiteMap(en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'SiteMap (US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'SiteMap (CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES ('OtherResources', 'Glossary', 'Welcome', '${HomePage}에 오신것을 환영합니다. (default)')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '${HomePage}에 오신것을 환영합니다. (ko-KR)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '${HomePage}에 오신것을 환영합니다. (ko)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'Welcome to ${HomePage} (en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'Welcome to ${HomePage} (US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'Welcome to ${HomePage} (CA)')


INSERT INTO RCL_RESOURCE (ASSEMBLY_NAME, SECTION_NAME, RES_KEY, RES_VALUE) VALUES ('OtherResources', 'CommonTerms', 'Hello', '안녕하세요. ${Glossary|HomePage}에 오신것을 환영합니다.')

SET @RES_ID = @@IDENTITY

INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko-KR', '안녕하세요. ${Glossary|HomePage}에 오신것을 환영합니다.')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'ko', '안녕하세요. ${Glossary|HomePage}에 오신것을 환영합니다.')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en', 'Hello, Welcome to ${Glossary|HomePage} (en)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-US', 'Hello, Welcome to ${Glossary|HomePage} (US)')
INSERT INTO RCL_RESOURCE_LOCALE (RES_ID, LOCALE_KEY, RES_VALUE) VALUES( @RES_ID, 'en-CA', 'Hello, Welcome to ${Glossary|HomePage} (CA)')


GO

SELECT  R.RES_ID
	  , R.ASSEMBLY_NAME
	  , R.RES_KEY
	  , RL.LOCALE_KEY
	  , RL.RES_VALUE
FROM    RCL_RESOURCE AS R
	  , RCL_RESOURCE_LOCALE RL
WHERE   R.RES_ID=RL.RES_ID
ORDER BY R.RES_ID

GO
 